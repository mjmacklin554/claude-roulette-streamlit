<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">
<!--
generated by Pygments <https://pygments.org/>
Copyright 2006-2025 by the Pygments team.
Licensed under the BSD license, see LICENSE for details.
-->
<html>
<head>
  <title></title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <style type="text/css">
/*
generated by Pygments <https://pygments.org/>
Copyright 2006-2025 by the Pygments team.
Licensed under the BSD license, see LICENSE for details.
*/
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
body .hll { background-color: #ffffcc }
body { background: #f8f8f8; }
body .c { color: #3D7B7B; font-style: italic } /* Comment */
body .err { border: 1px solid #F00 } /* Error */
body .k { color: #008000; font-weight: bold } /* Keyword */
body .o { color: #666 } /* Operator */
body .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
body .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
body .cp { color: #9C6500 } /* Comment.Preproc */
body .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
body .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
body .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
body .gd { color: #A00000 } /* Generic.Deleted */
body .ge { font-style: italic } /* Generic.Emph */
body .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
body .gr { color: #E40000 } /* Generic.Error */
body .gh { color: #000080; font-weight: bold } /* Generic.Heading */
body .gi { color: #008400 } /* Generic.Inserted */
body .go { color: #717171 } /* Generic.Output */
body .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
body .gs { font-weight: bold } /* Generic.Strong */
body .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
body .gt { color: #04D } /* Generic.Traceback */
body .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
body .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
body .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
body .kp { color: #008000 } /* Keyword.Pseudo */
body .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
body .kt { color: #B00040 } /* Keyword.Type */
body .m { color: #666 } /* Literal.Number */
body .s { color: #BA2121 } /* Literal.String */
body .na { color: #687822 } /* Name.Attribute */
body .nb { color: #008000 } /* Name.Builtin */
body .nc { color: #00F; font-weight: bold } /* Name.Class */
body .no { color: #800 } /* Name.Constant */
body .nd { color: #A2F } /* Name.Decorator */
body .ni { color: #717171; font-weight: bold } /* Name.Entity */
body .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
body .nf { color: #00F } /* Name.Function */
body .nl { color: #767600 } /* Name.Label */
body .nn { color: #00F; font-weight: bold } /* Name.Namespace */
body .nt { color: #008000; font-weight: bold } /* Name.Tag */
body .nv { color: #19177C } /* Name.Variable */
body .ow { color: #A2F; font-weight: bold } /* Operator.Word */
body .w { color: #BBB } /* Text.Whitespace */
body .mb { color: #666 } /* Literal.Number.Bin */
body .mf { color: #666 } /* Literal.Number.Float */
body .mh { color: #666 } /* Literal.Number.Hex */
body .mi { color: #666 } /* Literal.Number.Integer */
body .mo { color: #666 } /* Literal.Number.Oct */
body .sa { color: #BA2121 } /* Literal.String.Affix */
body .sb { color: #BA2121 } /* Literal.String.Backtick */
body .sc { color: #BA2121 } /* Literal.String.Char */
body .dl { color: #BA2121 } /* Literal.String.Delimiter */
body .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
body .s2 { color: #BA2121 } /* Literal.String.Double */
body .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
body .sh { color: #BA2121 } /* Literal.String.Heredoc */
body .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
body .sx { color: #008000 } /* Literal.String.Other */
body .sr { color: #A45A77 } /* Literal.String.Regex */
body .s1 { color: #BA2121 } /* Literal.String.Single */
body .ss { color: #19177C } /* Literal.String.Symbol */
body .bp { color: #008000 } /* Name.Builtin.Pseudo */
body .fm { color: #00F } /* Name.Function.Magic */
body .vc { color: #19177C } /* Name.Variable.Class */
body .vg { color: #19177C } /* Name.Variable.Global */
body .vi { color: #19177C } /* Name.Variable.Instance */
body .vm { color: #19177C } /* Name.Variable.Magic */
body .il { color: #666 } /* Literal.Number.Integer.Long */

  </style>
</head>
<body>
<h2></h2>

<div class="highlight"><pre><span></span><span class="gh"># Roulette Betting System - Streamlit Application Flowchart</span>
Date: 2025-10-20
Updated: Streamlit Web Application with File Input and User Configuration

<span class="gu">## Main Program Flow</span>

START (Streamlit App)
  ↓
Streamlit UI Configuration
├─ Title: &quot;Michael&#39;s Roulette System Configuration&quot;
├─ File Input Section:
│  ├─ Checkbox: &quot;Load outcomes from file&quot;
│  ├─ File Selector: Excel/CSV files from &#39;numbers&#39; folder
│  └─ File Loading: Read outcomes from selected file or use defaults
├─ Sequence Code Selection:
│  ├─ Option 1: &quot;Standard (3, 4, 2)&quot;
│  └─ Option 2: &quot;Alternative (8, 44, 10)&quot;
├─ Stage 2 Divisor Input: Default 8, range 1-32
└─ Run Button: &quot;Run Simulation&quot;
  ↓
Initialize System Variables (when Run button pressed)
├─ Load outcomes from file OR use defaults
├─ Set A1 = [2,3,5,6,17,18,20,21,25,26,28,29,31,32,34,35] (16 corner bets)
├─ Set A2 = [1-6,13-18,19-24,25-30,31-36] (30 six-line bets)
├─ sequence_code = selected sequence codes
├─ recording = False, balance = 0, current_bet_type = 1
├─ stage = 1, stage2_divisor = user input
├─ cumulative_negative = {integer:0, decimal:0}
├─ cumulative_positive_chips = 0
├─ waiting_for_a1_losses = False
├─ four_corner_rule_active = False
├─ starting_bank = 250 units
└─ All counters and tracking variables = 0
  ↓
FOR EACH OUTCOME in outcomes:
  ↓
┌─────────────────────────────────────┐
│ Determine Win/Loss                  │
│ win = &#39;W&#39; if outcome in A1 else &#39;L&#39; │
└─────────────────────────────────────┘
  ↓
┌──────────────────────┐    ┌─────────────────────────────────┐
│ Is recording active? │NO  │ Check for first A1 win         │
│                      ├───→│ If win==&#39;W&#39;: recording = True   │
│                      │    │ Continue to next outcome        │
└──────┬───────────────┘    └─────────────────────────────────┘
       │YES
       ↓
┌─────────────────────────────────────────────────────────────┐
│ SEQUENCE CODE MANAGEMENT                                    │
├─ Check if pending_sequence_codes exist (from 4-corner rule) │
├─ If four_corner_rule_active: suppress code display         │
├─ Else: show current sequence codes in DataFrame            │
└─────────────────────────────────────────────────────────────┘
  ↓
┌─────────────────────────────────────────────────────────────┐
│ STAGE-DEPENDENT BETTING LOGIC                              │
├─ If stage == 1: Call place_bet(outcome) [STAGE 1]         │
│   ├─ Check A1 wait rule                                    │
│   │   ├─ If waiting_for_a1_losses: return 0 (no bet)      │
│   │   └─ Track non_a1_count, end wait after 3 non-A1     │
│   ├─ Determine bet based on current_bet_type               │
│   │   ├─ Bet1: 5 chips on A2 (+1/-5)                     │
│   │   ├─ Bet2: 4 chips on A1 (+5/-4)                     │
│   │   └─ Bet3: 8 chips on A1 (+10/-8)                    │
│   ├─ Handle mixed numbers for losses/wins                  │
│   ├─ Update balance and current_bet_type                   │
│   ├─ If A1 win: start A1 wait rule                        │
│   └─ If Bet3 lost: stage = 2, initialize Stage 2          │
├─ If stage == 2: Call place_stage2_bet() [STAGE 2]         │
│   ├─ Check if sequence codes displayed (no bet if not)     │
│   ├─ Check a ≤ 10 rule (bypass if negative &gt; 20 units)    │
│   ├─ Calculate base units: c ÷ divisor (minimum 1 unit)   │
│   ├─ Sequence Ending Check (a ≤ 4):                       │
│   │   ├─ Calculate chip deficit: -(neg_chips + pos_chips) │
│   │   ├─ Min recovery units = ceiling(deficit ÷ 5)        │
│   │   └─ Use max(base_units, min_recovery_units)          │
│   ├─ Bet on A1 numbers only                               │
│   ├─ Handle mixed numbers with BIP for wins               │
│   ├─ Update divisor if b &gt; 89 rule applies                │
│   ├─ Check recovery: negative + positive ≥ 0              │
│   └─ If recovered: stage = 3, display final mixed numbers │
├─ If stage == 3: Show &quot;STOP&quot; and success message           │
└─ Record bet and mixed numbers in DataFrame                 │
└─────────────────────────────────────────────────────────────┘
  ↓
┌─────────────────────────────────────────────────────────────┐
│ FOUR CORNER LOSS RULE TRACKING                             │
├─ Track consecutive_non_a1 counter                          │
├─ If outcome in A1: reset counter, end rule if active      │
├─ If outcome not in A1: increment counter                  │
├─ If counter == 4: activate four_corner_rule               │
└─────────────────────────────────────────────────────────────┘
  ↓
┌─────────────────────────────────────────────────────────────┐
│ SEQUENCE CODE UPDATE (ALWAYS EXECUTED)                     │
├─ is_a1_win = outcome in A1                                │
├─ Call update_sequence_codes(is_a1_win)                     │
│   ├─ If A1 win: apply win formula                         │
│   │   ├─ Calculate new &#39;a&#39; based on ranges               │
│   │   ├─ b = b - c                                        │
│   │   └─ c = (int(b/a)) * 2                              │
│   └─ If A1 loss: apply loss formula                       │
│       ├─ a = a + 1                                        │
│       ├─ b = b + c                                        │
│       ├─ If b &gt; 89: b = int((b+1)/2)                     │
│       └─ c = (int(b/a)) * 2                              │
├─ If four_corner_rule just triggered:                      │
│   ├─ Save calculated codes as pending_sequence_codes      │
│   └─ Will be applied after A1 outcome ends rule          │
├─ Update divisor if in Stage 2 and b &gt; 89 during betting  │
│   └─ Divisor progression: 8→4→2→1 (only during betting)  │
└─────────────────────────────────────────────────────────────┘
  ↓
┌─────────────────────────────────────────────────────────────┐
│ END CONDITIONS CHECK                                        │
├─ Stage 1: If current_bet_type &gt; 3: Stage 1 ends (Bet3 lost)│
├─ Stage 2: If full recovery achieved: Stage 2 ends          │
├─ Stage 2: If bank lost (1000 chips): Sequence ends in fail │
├─ Continue to next outcome if sequence not ended            │
└─────────────────────────────────────────────────────────────┘
  ↓
END FOR EACH OUTCOME
  ↓
Streamlit Output Display
├─ Display Results DataFrame with columns:
│  ├─ line, outcome, win, a, b, c
│  ├─ actual bet, negative, positive, balance
├─ Balance Progression Graph:
│  ├─ Matplotlib line chart
│  ├─ X-axis: Spin Number
│  ├─ Y-axis: Balance
│  └─ Break-even line at y=0
├─ System Messages:
│  └─ Debug messages and system events
└─ Final Results Summary:
   ├─ Starting Sequence Codes
   ├─ Total Sequences Completed
   ├─ Final Balance (chips)
   ├─ Final Bank (units)
   ├─ Session Status (ACTIVE/ENDED)
   └─ Outcomes Processed
  ↓
END PROGRAM

<span class="gu">## Rule Interaction Matrix</span>

┌──────────────────┬─────────┬────────────────┬────────────────┬─────────────────┐
│ State            │ Stage   │ Betting        │ Sequence Codes │ Display Codes   │
├──────────────────┼─────────┼────────────────┼────────────────┼─────────────────┤
│ Normal           │ 1 &amp; 2   │ Active         │ Update &amp; Show  │ Yes             │
│ A1 Wait          │ 1 only  │ STOPPED        │ Update &amp; Show  │ Yes             │
│ 4-Corner Active  │ 1       │ Active         │ Update Only    │ NO (suppressed) │
│ 4-Corner Active  │ 2       │ STOPPED        │ Update Only    │ NO (suppressed) │
│ 4-Corner Ended   │ 1 &amp; 2   │ Active         │ Apply Pending  │ Yes (delayed)   │
│ a &gt; 10           │ 2 only  │ STOPPED*       │ Update &amp; Show  │ Yes             │
│ Stage 2 Complete │ 3       │ None           │ Final Codes    │ Yes + &quot;STOP&quot;    │
└──────────────────┴─────────┴────────────────┴────────────────┴─────────────────┘
<span class="k">*</span><span class="w"> </span>Unless negative &gt; 20 units, then betting continues

<span class="gu">## Key Decision Points</span>

<span class="k">1.</span> <span class="gs">**Recording Started?**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>NO: Wait for first A1 win
<span class="w">   </span><span class="k">-</span><span class="w"> </span>YES: Process full logic

<span class="k">2.</span> <span class="gs">**A1 Wait Rule Active?**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>YES: No betting, but continue sequence codes
<span class="w">   </span><span class="k">-</span><span class="w"> </span>NO: Normal betting

<span class="k">3.</span> <span class="gs">**Four Corner Rule Active?**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>YES: Suppress sequence code display
<span class="w">   </span><span class="k">-</span><span class="w"> </span>NO: Show current codes

<span class="k">4.</span> <span class="gs">**Pending Sequence Codes?**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>YES: Apply and display delayed codes
<span class="w">   </span><span class="k">-</span><span class="w"> </span>NO: Display current codes

<span class="k">5.</span> <span class="gs">**Stage 1 Bet Result?**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Win: Reset to Bet1, check A1 wait trigger
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Loss: Progress to next bet type

<span class="k">6.</span> <span class="gs">**Stage 2 Entry Conditions?**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>a ≤ 10 AND sequence codes displayed
<span class="w">   </span><span class="k">-</span><span class="w"> </span>OR negative &gt; 20 units (bypass a ≤ 10 rule)

<span class="k">7.</span> <span class="gs">**Stage 2 Bet Calculation?**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>If a &gt; 4: Use min(base_units, risk_managed_units)
<span class="w">   </span><span class="k">-</span><span class="w"> </span>If a ≤ 4: Use max(base_units, min_recovery_units)
<span class="w">   </span><span class="k">-</span><span class="w"> </span>Ensures full recovery when sequence is ending

<span class="k">8.</span> <span class="gs">**Stage 2 Recovery Status?**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>negative + positive ≥ 0: Complete recovery → Stage 3
<span class="w">   </span><span class="k">-</span><span class="w"> </span>negative + positive &lt; 0: Continue Stage 2

<span class="k">9.</span> <span class="gs">**Divisor Update Needed?**</span>
<span class="w">   </span><span class="k">-</span><span class="w"> </span>During Stage 2 active betting only
<span class="w">   </span><span class="k">-</span><span class="w"> </span>When b &gt; 89 rule applies: divisor ÷ 2

<span class="gu">## Critical Timing Notes</span>

<span class="k">-</span><span class="w"> </span>Sequence codes calculated AFTER outcome, applied to CURRENT line display
<span class="k">-</span><span class="w"> </span>Stage 1: A1 wait rule affects NEXT line onwards (betting only)
<span class="k">-</span><span class="w"> </span>Stage 1: Four corner rule suppresses NEXT line display but allows betting
<span class="k">-</span><span class="w"> </span>Stage 2: Four corner rule suppresses NEXT line display AND stops betting
<span class="k">-</span><span class="w"> </span>Stage 2: Betting only when sequence codes are displayed
<span class="k">-</span><span class="w"> </span>Stage 2: Divisor changes only during active betting periods
<span class="k">-</span><span class="w"> </span>Betting resumes line AFTER wait periods end
<span class="k">-</span><span class="w"> </span>Mixed numbers carry forward from Stage 1 to Stage 2
<span class="k">-</span><span class="w"> </span>Recovery completion triggers Stage 3 with &quot;STOP&quot; display
<span class="k">-</span><span class="w"> </span>All rules can be active simultaneously with stage-specific behaviors
</pre></div>
</body>
</html>
